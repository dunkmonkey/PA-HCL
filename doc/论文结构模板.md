# 1. Introduction
    
    - 生理音频 SSL 的 gap

### 1.1 研究背景与意义

**写什么**

- 心音听诊在临床中的重要性
- AI 在心音分析中的作用
- 标注成本高 → 自监督学习的必要性
    

**一定要点**

- 心音 ≠ 语音 ≠ 环境音
- 心音具有明确生理结构（周期性、亚结构）

📌 **答辩老师关注**

> 你做这个课题是否“有必要、有价值”

---

### 1.2 国内外研究现状

**结构建议**

- 心音分析方法
- 音频自监督学习
- 生理信号自监督学习

**写作方式（不要列点）**

> “XXX 方法取得进展，但忽略了 XXX，限制了在心音场景下的表现。”

📌 **这里埋下你创新的“动机伏笔”**

---

### 1.3 研究问题与挑战

明确指出 **3 个核心挑战**：

1. 心音的生理结构如何在自监督中建模？
2. 如何同时学习局部病理与全局周期？
3. 表征如何具备良好的跨任务迁移性？

---

### 1.4 研究内容与创新点

**直接列出 3–4 个创新点**

- 生理结构感知的层次化对比学习
- CNN–SSM 多尺度编码器
- 病理敏感的对比目标设计

📌 **这里就是你之后所有章节的索引**

# 2. Related Work
    - Audio SSL
    - Biomedical SSL

### 2.1 心音信号与生理机制基础

- 心动周期
- S1 / S2 / 杂音
- 心率与病理的关系

📌 **为“结构感知”做医学铺垫**

---

### 2.2 深度学习在心音分析中的应用

- CNN / RNN / Transformer
- 现有方法的局限

---

### 2.3 自监督与对比学习理论

- SimCLR
- BYOL
- InfoNCE 损失

📌 **不要写太多公式，重在思想**

---

### 2.4 本章小结

> 自然引出：**现有方法缺乏生理结构建模**

# 3. Method
    - Overview
    - Hierarchical Contrastive Learning
    - CNN–SSM Encoder

### 3.1 方法总体框架概述

- 给出方法框图（论文级）
- 说明整体流程

针对心音信号具有显著生理结构特征而现有通用音频自监督学习方法普遍忽略该结构的问题，本文提出一种**面向心音生理结构的层次化自监督对比学习框架**（Physiology-Aware Hierarchical Contrastive Learning, PA-HCL）。该方法在自监督预训练阶段显式引入心动周期及其亚结构信息，通过多层次对比学习目标，引导模型学习同时具有**局部病理敏感性**与**全局周期稳定性**的心音表征。

如图 X 所示，所提出的 PA-HCL 框架主要由三部分组成：  
（1）心音生理结构建模模块，用于在无人工标注条件下构建心动周期级与亚结构级单元；  
（2）多尺度心音编码器，用于提取不同时间尺度的特征表征；  
（3）层次化自监督对比学习策略，在不同生理层次施加相应的对比约束。

通过上述设计，模型能够在预训练阶段充分挖掘大规模无标注心音数据中蕴含的生理先验，从而获得具有良好迁移性能的通用心音表征。

---

### 3.2 心音生理结构建模

#### 3.2.1 心动周期级结构定义

- 如何近似提取周期
- 不依赖标签的说明


心音信号是由心脏机械活动产生的准周期性生理信号，其基本组成单元为心动周期。一个完整的心动周期通常包含第一心音（S1）、第二心音（S2）以及其间的收缩期与舒张期。与语音或环境音频不同，心动周期在同一受试者内具有较强的一致性，而病理异常往往表现为周期结构的形态改变或能量分布异常。

在自监督学习场景下，本文不依赖人工标注的 S1/S2 边界，而是采用**弱结构近似策略**对心动周期进行建模。具体而言，首先对原始心音信号进行带通滤波与归一化处理，然后计算其短时能量包络。通过自适应阈值方法检测能量峰值位置，并将相邻峰值之间的信号段视为一个心动周期单元。该方法不追求精确的生理分割，而是为后续对比学习提供稳定的一致性结构基础。

需要强调的是，心动周期信息仅用于构建自监督对比学习中的正负样本关系，并未作为任何形式的监督标签参与模型训练，从而保证了方法的自监督属性。



#### 3.2.2 亚结构级单元构建

- 子结构划分策略
- 生理合理性解释

尽管心动周期能够刻画心音的全局节律特征，但大量心脏杂音与异常冲击信号往往局部出现于周期内部的特定时间区域。仅基于周期级建模难以充分捕捉此类局部病理信息。

为此，本文在心动周期级结构的基础上进一步引入**亚结构级单元**建模策略。具体做法为：在每一个心动周期内，将周期信号按照时间轴均匀划分为若干个子片段（本文中设定为 K 个子结构单元）。每一个子片段被视为一个亚结构单元，用于表征周期内部的局部时序特征。

该划分方式具有以下优点：  
（1）不依赖精确的 S1/S2 标注，避免引入额外监督；  
（2）在统计意义上保持子结构在不同周期之间的相对一致性；  
（3）为局部病理特征的建模提供合理的对比单元。

通过心动周期级与亚结构级的联合建模，本文构建了一个符合心音生理生成机制的层次化结构表示体系。

### 3.3.3 增加损失权重的理论推导：

```math
   \lambda_1 = \frac{1}{\text{周期长度}} \times \text{周期内亚结构数量}
   \lambda_2 = \frac{1}{\text{亚结构数量}} \times \text{亚结构长度}
```
  
- **在实验中验证**：在不同K值（2/4/6）下，最优λ的规律
- **论文中强调**：这是**首次将生理结构复杂度纳入损失权重设计**，超越普通对比学习



📌 **这是你第一个“方法创新点”**

---

### 3.3 层次化自监督对比学习策略

#### 3.3.1 周期级对比学习目标

- 正负样本构造
- 损失函数


心动周期级对比学习旨在引导模型学习对心率变化与信号增强具有鲁棒性、同时对周期整体形态变化保持敏感的高层语义表征。
在周期级对比学习中，正样本对由同一心音记录中不同心动周期，或同一周期在不同数据增强条件下得到的样本构成；负样本则选自不同心音记录或不同受试者的周期单元。通过该构造方式，模型被迫学习跨周期的一致性结构，从而弱化心率波动等非病理因素的影响。
本文采用基于 InfoNCE 的对比损失函数，其形式如下：

[  
\mathcal{L}_{cycle} = -\log \frac{\exp(\mathrm{sim}(z_c, z_c^+)/\tau)}{\sum_{j} \exp(\mathrm{sim}(z_c, z_j)/\tau)}  
]

其中，(z_c) 表示周期级特征嵌入，(\mathrm{sim}(\cdot)) 为余弦相似度函数，(\tau) 为温度系数。

**创新技术点：** 使用动态时间规整（DTW）对正样本对进行预对齐，确保损失函数计算时是在“语义点”对齐的基础上进行的。
#### 3.3.2 亚结构级对比学习目标

- 局部病理建模
- 与周期级的互补性


亚结构级对比学习主要关注心动周期内部的局部时序与频谱特征，尤其是与杂音、异常冲击相关的短时模式。
在亚结构级对比学习中，正样本对由同一周期内相同位置的亚结构单元在不同增强条件下构成，或由不同周期中相对位置一致的亚结构单元构成；负样本则来自不同位置的亚结构或不同个体的亚结构单元。

(\mathcal{L}_{sub}) = - \log \frac{\exp(\text{sim}(z_s, z_s^+)/\tau)}{\sum_j \exp(\text{sim}(z_s, z_j)/\tau)}，其中 z_s 表示亚结构级嵌入表示，τ 为温度系数。


---

### 3.4 联合优化与训练策略

- 损失加权
    
- 训练流程

为同时学习周期级与亚结构级表征，本文采用加权联合优化策略对两个层次的对比损失进行整合，整体训练目标定义为：

[  
\mathcal{L} = \lambda_1 \mathcal{L}_{cycle} + \lambda_2 \mathcal{L}_{sub}  
]

其中，(\lambda_1) 与 (\lambda_2) 分别控制周期级与亚结构级损失的权重。实验中通过验证集选择合适的权重比例。在训练初期，适当提高亚结构级损失权重以增强模型对局部模式的感知能力；在训练后期逐步提升周期级损失权重，以强化全局结构一致性。
通过上述联合优化策略，模型能够在无监督条件下学习具有明确生理意义的层次化心音表征。


在模型训练阶段，首先对原始心音信号进行预处理，包括去噪、归一化和标准化，然后对每条心音信号进行多种数据增强操作，如随机裁剪、幅值扰动、时间遮挡、频谱扰动和轻微的速度变化，以生成多视图样本用于对比学习。每个心动周期及其子结构单元都会被单独增强，以保证周期级和亚结构级特征的一致性和多样性。
增强后的心音片段首先输入多尺度卷积神经网络提取局部时序特征，然后通过状态空间模型（SSM）对长时序依赖进行建模，得到周期级特征嵌入。在中间卷积层提取的亚结构级特征与周期级特征分别用于计算亚结构级对比损失和周期级对比损失。正样本对由同一周期或同一子结构的不同增强视图构成，负样本对则来自不同周期或不同个体的心音片段。
训练过程中，采用加权联合损失函数将周期级和亚结构级对比损失整合，利用端到端反向传播进行优化。训练流程包括：每个批次随机采样若干心音周期 → 对每个周期及其子结构进行增强 → 提取多尺度特征 → 计算各层对比损失 → 反向传播更新模型参数。通过多轮迭代，模型逐步学习到既保留全局周期信息又敏感于局部病理特征的判别性表征，为下游分类、异常检测和分割任务提供高质量的特征初始化。


📌 **这一章基本可以直接改写成期刊论文 Method**

### 3.5 多尺度心音表征编码器设计

> 这一章回答：**你的方法“凭什么能承载这些目标”**

---

### 3.5.1 设计动机与总体结构

- 心音多尺度特性
- CNN vs Transformer vs SSM

---

### 3.5.2 多尺度 CNN 特征提取模块

- 卷积核设计
    
- 作用：局部病理
    

---

### 3.5.3 基于状态空间模型的周期建模模块

- Mamba / SSM 原理（简要）
- 适合心音的原因

---

### 3.5.4 不同层级表征的对齐方式

- 哪一层用于哪种对比
- Projection head 设计

📌 **这是“工程 + 理论结合”的体现** ==
# 4. Experiments
    
    - Dataset
        
    - Setup
        
    - Results
        
    - Ablation

### 4.1 实验数据集与预处理

- 私有数据
    
- CirCor / PhysioNet


表 4-1 数据集与任务说明表

| 数据集            | 样本数  | 采样率  | 任务类型    | 标签  |
| -------------- | ---- | ---- | ------- | --- |
| 私有心音数据         | xxxx | xxxx | SSL 预训练 | 无   |
| CirCor         | xxxx | xxxx | 正常/异常   | 有   |
| PhysioNet 2016 | xxxx | xxxx | 分类      | 有   |


---

### 4.2 实验设置

- 预训练细节
- [ ] 编码器类型
- [ ] 参数量
- [ ] 预训练 epoch
- [ ] batch size
- [ ] 总时长
- 微调策略
    

---

### 4.3 与现有方法的对比实验

- 分类
- 异常检测

表 4-2 不同自监督方法的分类性能比较（核心主表）

| 方法               | 预训练 | Accuracy (%) | AUC   | F1    |
| ---------------- | --- | ------------ | ----- | ----- |
| 1D-CNN           | ✗   |              |       |       |
| wav2vec 2.0      | ✓   |              |       |       |
| BYOL-A           | ✓   |              |       |       |
| SimCLR-A         | ✓   |              |       |       |
| **本文方法（PA-HCL）** | ✓   | **↑**        | **↑** | **↑** |

表 4-3 异常检测性能比较（AUROC / AUPRC）

| 方法          | AUROC | AUPRC |
| ----------- | ----- | ----- |
| Autoencoder |       |       |
| Deep SVDD   |       |       |
| BYOL-A      |       |       |
| **本文方法**    | **↑** | **↑** |

📌 **必须有统计显著性分析**

---

### 4.4 消融实验

- 无结构 vs 有结构
- cycle vs sub
- 编码器替换

表 4-4 层次结构消融实验（非常重要）

| 设置              | Cycle-level | Sub-level | AUC   |
| --------------- | ----------- | --------- | ----- |
| Baseline SSL    | ✗           | ✗         |       |
| Only Cycle      | ✓           | ✗         |       |
| Only Sub        | ✗           | ✓         |       |
| **Cycle + Sub** | ✓           | ✓         | **↑** |
表 4-5 编码器结构消融实验

|编码器|AUC|F1|
|---|---|---|
|CNN only|||
|CNN + Transformer|||
|**CNN + Mamba**|**↑**|**↑**|

表 4-6 不同损失权重对性能的影响

| λ₁ : λ₂   | AUC   |
| --------- | ----- |
| 1 : 0     |       |
| 0 : 1     |       |
| 1 : 0.5   |       |
| **1 : 1** | **↑** |
表 4-7 跨数据集迁移实验（T-BME 加分项）

|预训练|测试数据|AUC|
|---|---|---|
|无预训练|CirCor||
|公共数据 SSL|CirCor||
|**私有数据 SSL（本文）**|CirCor|**↑**|

---

### 4.5 表征可视化与可解释性分析

- t-SNE / UMAP
- Grad-CAM
    
---

### 4.6 结果讨论

- 为什么有效
- 失败案例


补充实验：
1. 采样率鲁棒性（表 5-9 扩表）  
    预训练 2 kHz，下游分别微调 1、2、4、8 kHz；报告 AUROC 下降 <1.5%，证明临床设备差异无碍。
    
2. 设备泛化（跨硬件）  
    用电子听诊器 3M™ Littmann 3200 采集 200 例，与现有 Welch Allyn 数据混合 subject-wise split；  
    要求 AUROC 下降 <2%，否则加“设备风格迁移”小模块（1×1 卷积+BN）。
    
3. 小样本极端应力测试  
    下游训练集只给 5、10、20 例/类，PA-HCL vs 随机初始化 CNN；  
    目标：5 例时 PA-HCL↑15% F1，10 例↑8%，20 例↑3%，曲线越陡峭越好。
    
4. 对抗扰动生理合理性  
    向心音注入 20 dB 高斯白噪声、呼吸音、说话声；  
    要求 AUROC 下降 <4%，并给出“增强策略消融”——SpecAugment 时间 mask 宽度≤30 ms 最佳，与心音短时傅里叶特性一致。



# 5. Discussion
    
    - 生理意义
        
    - 泛化能力
- 

# 6. Conclusion
### 6.1 研究工作总结

- 重申创新点
    
- 重申实验结论
    

---

### 6.2 不足与未来工作

- 更精细的结构建模
    
- 多模态（ECG + PCG）
    
- 临床验证
    

📌 **这一章非常重要，体现科研视野**



**论文主题主线**

> 面向心音信号的生理结构感知自监督对比学习方法研究

**论文核心贡献**

- 不依赖人工标注
- 引入心动生理结构
- 学习可迁移的心音表征
- 服务多种下游医学任务